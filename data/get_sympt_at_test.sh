#!/bin/sh
county=$1
echo "Tallying data on people w/ symptoms on or before positive test..."
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive") {total++;if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { printf("%s vs %s (admin=%s, death=%s\n",$9,$1,$10,$5);}}}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}} END {printf("pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "02" || a[2] == "03") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Feb-Mar: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "04") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Apr: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "05") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("May: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "06") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Jun: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "07") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Jul: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "08") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Aug: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "09") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Sept: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "10") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Oct: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "11") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Nov: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
cat IDM_$county\_county.csv|awk -F',' '{if ($8 == "Positive" &&($1 != "" || $2 != "")){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "12") {total++; if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && ($9 != "" && $9 != "FALSE" && $9 <= $1)||($10 !="" && $10!="FALSE")||($5=="Dead" && $6=="Yes")) { sympt++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Dec: pos=%d, sympt=%d(%g%%) (0-19=%g%%,20-50=%g%%,50-70=%g%%,70+=%g%%)\n",total,sympt,100*sympt/total,100*child/child_total,100*adult/adult_total,100*older/older_total,100*senior/senior_total);}'
