#!/bin/sh
#This script is used to populate the monthly variables for death_fract in kc_global_params.R
#
echo "Tallying deaths by month/age..."
#cat IDM_king_county.csv|awk -F',' '{if ($8 == "Positive") {total++;if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if (NR>1 && $3 != "" && $5=="Dead" && $6=="Yes") { print $10;}}}'
cat IDM_king_county.csv|awk -F',' '{if (NR>1 && $8 == "Positive") {total++;if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if ($3 != "" && $5=="Dead" && $6=="Yes") { dead++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}} END {printf("hosp=%d, dead=%d(%g) (0-19=%g,20-50=%g,50-70=%g,70+=%g)\n",total,dead,dead/total,child/child_total,adult/adult_total,older/older_total,senior/senior_total);}'
cat IDM_king_county.csv|awk -F',' '{if (NR>1 && ($1 != "" || $2 != "") && $8 == "Positive"){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "02" || a[2] == "03") {total++;if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if ($3 != "" && $5=="Dead" && $6=="Yes") { dead++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Feb-Mar: hosp=%d, dead=%d(%g) (0-19=%g,20-50=%g,50-70=%g,70+=%g)\n",total,dead,dead/total,child/child_total,adult/adult_total,older/older_total,senior/senior_total);}'
cat IDM_king_county.csv|awk -F',' '{if (NR>1 && ($1 != "" || $2 != "") && $8 == "Positive"){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "04") {total++;if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if ($3 != "" && $5=="Dead" && $6=="Yes") { dead++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Apr: hosp=%d, dead=%d(%g) (0-19=%g,20-50=%g)50-70=%g,70+=%g)\n",total,dead,dead/total,child/child_total,adult/adult_total,older/older_total,senior/senior_total);}'
cat IDM_king_county.csv|awk -F',' '{if (NR>1 && ($1 != "" || $2 != "") && $8 == "Positive"){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "05") {total++;if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if ($3 != "" && $5=="Dead" && $6=="Yes") { dead++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("May: hosp=%d, dead=%d(%g) (0-19=%g,20-50=%g)50-70=%g,70+=%g)\n",total,dead,dead/total,child/child_total,adult/adult_total,older/older_total,senior/senior_total);}'
cat IDM_king_county.csv|awk -F',' '{if (NR>1 && ($1 != "" || $2 != "") && $8 == "Positive"){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "06") {total++;if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if ($3 != "" && $5=="Dead" && $6=="Yes") { dead++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Jun: hosp=%d, dead=%d(%g) (0-19=%g,20-50=%g)50-70=%g,70+=%g)\n",total,dead,dead/total,child/child_total,adult/adult_total,older/older_total,senior/senior_total);}'
cat IDM_king_county.csv|awk -F',' '{if (NR>1 && ($1 != "" || $2 != "") && $8 == "Positive"){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "07") {total++;if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if ($3 != "" && $5=="Dead" && $6=="Yes") { dead++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Jul: hosp=%d, dead=%d(%g) (0-19=%g,20-50=%g)50-70=%g,70+=%g)\n",total,dead,dead/total,child/child_total,adult/adult_total,older/older_total,senior/senior_total);}'
cat IDM_king_county.csv|awk -F',' '{if (NR>1 && ($1 != "" || $2 != "") && $8 == "Positive"){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "08") {total++;if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if ($3 != "" && $5=="Dead" && $6=="Yes") { dead++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Aug: hosp=%d, dead=%d(%g) (0-19=%g,20-50=%g)50-70=%g,70+=%g)\n",total,dead,dead/total,child/child_total,adult/adult_total,older/older_total,senior/senior_total);}'
cat IDM_king_county.csv|awk -F',' '{if (NR>1 && ($1 != "" || $2 != "") && $8 == "Positive"){if ($1 != ""){is_uncertain=0;split($1,a,"-");}else{is_uncertain=1;split($2,a,"-");}if (a[2] == "09") {total++;if ($4 < 20){child_total++;}else{if ($4 < 50){adult_total++;}else{if ($4 < 70){older_total++;}else{senior_total++;}}}if ($3 != "" && $5=="Dead" && $6=="Yes") { dead++; if ($4 < 20){child++;}else{if ($4 < 50){adult++;}else{if ($4 < 70){older++;}else{senior++}}}}}}} END {printf("Sept: hosp=%d, dead=%d(%g) (0-19=%g,20-50=%g)50-70=%g,70+=%g)\n",total,dead,dead/total,child/child_total,adult/adult_total,older/older_total,senior/senior_total);}'
